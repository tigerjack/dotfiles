#!/bin/bash - 
#===============================================================================
#
#          FILE: generate_from_global_env.sh
# 
#         USAGE: ./generate_from_global_env.sh 
# 
#   DESCRIPTION: 
# 
#       OPTIONS: ---
#  REQUIREMENTS: ---
#          BUGS: ---
#         NOTES: ---
#        AUTHOR: YOUR NAME (), 
#  ORGANIZATION: 
#       CREATED: 09/05/2019 21:05
#      REVISION:  ---
#===============================================================================

set -o nounset                              # Treat unset variables as an error
# declare -a arr=("$XDG_CONFIG_HOME/i3/config");
declare -a arr=("$XDG_CONFIG_HOME/user-dirs.dirs" "$XDG_CONFIG_HOME/taskwarrior/taskrc" "$XDG_CONFIG_HOME/i3/config" "$XDG_CONFIG_HOME/anacrontab");
vars=$(awk 'BEGIN{for(v in ENVIRON) print "$" v}' | grep -e "XDG.*HOME" -e "MDIR_.*" | tr '\n' ' ')
echo "$vars"
for i in "${arr[@]}";
do
    echo "Replacing vars in $i.template"
    echo -e "#WARNING: autogenerated with bin/generate_user_dirs.sh,\n#change the .template file and rerun the script" > "$i" 
    envsubst "\$HOME $vars" < "$i.template" >> "$i"
done
